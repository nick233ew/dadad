<html>
 <head>
  <title>
   Discord Clone
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
  <style>
   body {
            font-family: 'Roboto', sans-serif;
        }
  </style>
 </head>
 <body class="bg-gray-800 text-white">
  <div class="flex h-screen">
   <!-- Sidebar -->
   <div class="w-16 bg-gray-900 flex flex-col items-center py-4 space-y-4">
    <div class="w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center">
     <i class="fab fa-discord text-2xl">
     </i>
    </div>
    <div class="w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center cursor-pointer" onclick="openSettings()">
     <i class="fas fa-cog text-xl">
     </i>
    </div>
   </div>
   <!-- Chat Area -->
   <div class="flex-1 flex flex-col">
    <div class="h-16 bg-gray-900 flex items-center px-4">
     <i class="fas fa-hashtag text-gray-400">
     </i>
     <span class="ml-2 text-xl">
      yassine
     </span>
    </div>
    <div class="flex-1 overflow-y-auto p-4 space-y-4" id="chat-messages">
    </div>
    <div class="h-16 bg-gray-900 flex items-center px-4">
     <input class="w-full bg-gray-700 text-white px-4 py-2 rounded-lg focus:outline-none" id="message-input" placeholder="Message #yassine" type="text"/>
     <button class="ml-4 bg-blue-500 px-4 py-2 rounded-lg" onclick="sendMessage()">
      Send
     </button>
    </div>
   </div>
  </div>
  <!-- Modal for changing avatar and username -->
  <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" id="settings-modal">
   <div class="bg-gray-800 p-6 rounded-lg w-96">
    <h2 class="text-xl mb-4">
     Settings
    </h2>
    <div class="mb-4">
     <label class="block mb-2">
      Username
     </label>
     <input class="w-full bg-gray-700 text-white px-4 py-2 rounded-lg focus:outline-none" id="username-input" placeholder="Enter new username" type="text"/>
    </div>
    <div class="mb-4">
     <label class="block mb-2">
      Avatar
     </label>
     <input class="w-full bg-gray-700 text-white px-4 py-2 rounded-lg focus:outline-none" id="avatar-input" type="file" accept="image/*"/>
    </div>
    <div class="mb-4">
     <label class="block mb-2">
      Status
     </label>
     <select class="w-full bg-gray-700 text-white px-4 py-2 rounded-lg focus:outline-none" id="status-input">
      <option value="online">
       Online
      </option>
      <option value="idle">
       Idle
      </option>
      <option value="dnd">
       Do Not Disturb
      </option>
      <option value="invisible">
       Invisible
      </option>
     </select>
    </div>
    <div class="flex justify-end">
     <button class="bg-blue-500 px-4 py-2 rounded-lg mr-2" onclick="saveSettings()">
      Save
     </button>
     <button class="bg-red-500 px-4 py-2 rounded-lg" onclick="closeSettings()">
      Cancel
     </button>
    </div>
   </div>
  </div>
  <script>
   let currentUsername = 'Yassine';
    let currentAvatar = 'https://storage.googleapis.com/a1aa/image/2nR9y2uYl1LUG5yNXtCivaPMj2atxOItNh4RvLyisJTxek3JA.jpg';
    let currentStatus = 'online';
    let messages = JSON.parse(localStorage.getItem('messages')) || [];

    function toggleMicrophone() {
        alert('Microphone toggled');
    }

    function toggleHeadphones() {
        alert('Headphones toggled');
    }

    function openSettings() {
        document.getElementById('settings-modal').classList.remove('hidden');
    }

    function closeSettings() {
        document.getElementById('settings-modal').classList.add('hidden');
    }

    function saveSettings() {
        const newUsername = document.getElementById('username-input').value.trim();
        const avatarInput = document.getElementById('avatar-input');
        const newAvatar = avatarInput.files[0];
        const newStatus = document.getElementById('status-input').value;

        if (newUsername !== '') {
            currentUsername = newUsername;
            document.querySelectorAll('span.font-bold').forEach(element => {
                element.textContent = currentUsername;
            });
        }

        if (newAvatar) {
            const reader = new FileReader();
            reader.onload = function (e) {
                currentAvatar = e.target.result;
                document.querySelectorAll('img[alt="User avatar"]').forEach(element => {
                    element.src = currentAvatar;
                });
            };
            reader.readAsDataURL(newAvatar);
        }

        currentStatus = newStatus;

        // Save settings to localStorage
        localStorage.setItem('currentUsername', currentUsername);
        localStorage.setItem('currentAvatar', currentAvatar);
        localStorage.setItem('currentStatus', currentStatus);

        closeSettings();
    }

    function sendMessage() {
        const messageInput = document.getElementById('message-input');
        const messageText = messageInput.value.trim();
        if (messageText !== '') {
            const message = {
                username: currentUsername,
                avatar: currentAvatar,
                text: messageText,
                timestamp: new Date().toLocaleTimeString()
            };
            messages.push(message);
            localStorage.setItem('messages', JSON.stringify(messages));
            displayMessages();
            messageInput.value = '';
        }
    }

    function displayMessages() {
        const chatMessages = document.getElementById('chat-messages');
        chatMessages.innerHTML = '';
        messages.forEach(message => {
            const newMessage = document.createElement('div');
            newMessage.classList.add('flex', 'items-start', 'space-x-4');
            newMessage.innerHTML = `
                <img src="${message.avatar}" alt="User avatar" class="rounded-full" width="48" height="48">
                <div>
                    <div class="flex items-center space-x-2">
                        <span class="font-bold">${message.username}</span>
                        <span class="text-xs text-gray-400">${message.timestamp}</span>
                    </div>
                    <p>${message.text}</p>
                </div>
            `;
            chatMessages.appendChild(newMessage);
        });
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Display messages on page load
    displayMessages();

    // Load settings from localStorage on page load
    window.addEventListener('load', function () {
        currentUsername = localStorage.getItem('currentUsername') || currentUsername;
        currentAvatar = localStorage.getItem('currentAvatar') || currentAvatar;
        currentStatus = localStorage.getItem('currentStatus') || currentStatus;

        document.querySelectorAll('span.font-bold').forEach(element => {
            element.textContent = currentUsername;
        });

        document.querySelectorAll('img[alt="User avatar"]').forEach(element => {
            element.src = currentAvatar;
        });
    });

    // Listen for storage events to update messages and settings in real-time
    window.addEventListener('storage', function (event) {
        if (event.key === 'messages') {
            messages = JSON.parse(event.newValue) || [];
            displayMessages();
        } else if (event.key === 'currentUsername') {
            currentUsername = event.newValue;
            document.querySelectorAll('span.font-bold').forEach(element => {
                element.textContent = currentUsername;
            });
        } else if (event.key === 'currentAvatar') {
            currentAvatar = event.newValue;
            document.querySelectorAll('img[alt="User avatar"]').forEach(element => {
                element.src = currentAvatar;
            });
        } else if (event.key === 'currentStatus') {
            currentStatus = event.newValue;
        }
    });
  </script>
 </body>
</html>
